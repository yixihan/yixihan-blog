(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{417:function(t,a,r){"use strict";r.r(a);var s=r(2),e=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"dhcp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dhcp"}},[t._v("#")]),t._v(" DHCP")]),t._v(" "),a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/265293856",target:"_blank",rel:"noopener noreferrer"}},[t._v("DHCP协议详解"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("DHCP（Dynamic Host Configuration Protocol，动态主机配置协议），前身是BOOTP协议，是一个局域网的网络协议")]),t._v(" "),a("p",[a("strong",[t._v("使用UDP协议工作")])]),t._v(" "),a("p",[a("strong",[t._v("统一使用两个IANA分配的端口：67（服务器端），68（客户端）")])]),t._v(" "),a("p",[t._v("DHCP通常被用于局域网环境，"),a("strong",[t._v("主要作用是集中的管理、分配IP地址")]),t._v("，使client动态的获得IP地址、Gateway地址、DNS服务器地址等信息，并能够提升地址的使用率")]),t._v(" "),a("p",[t._v("简单来说，DHCP就是一个不需要账号密码登录的、自动给内网机器分配IP地址等信息的协议")]),t._v(" "),a("h2",{attrs:{id:"dhcp-报文种类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dhcp-报文种类"}},[t._v("#")]),t._v(" DHCP 报文种类")]),t._v(" "),a("h3",{attrs:{id:"discover"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#discover"}},[t._v("#")]),t._v(" Discover")]),t._v(" "),a("p",[a("strong",[t._v("广播发现DHCP服务器")])]),t._v(" "),a("p",[t._v("DHCP客户端在请求IP地址时并不知道DHCP服务器的位置，因此DHCP客户端会在本地网络内以广播方式发送Discover请求报文，以发现网络中的DHCP服务器。所有收到Discover报文的DHCP服务器都会发送应答报文，DHCP客户端据此可以知道网络中存在的DHCP服务器的位置")]),t._v(" "),a("h3",{attrs:{id:"offer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#offer"}},[t._v("#")]),t._v(" Offer")]),t._v(" "),a("p",[a("strong",[t._v("DHCP服务器有可用IP地址")])]),t._v(" "),a("p",[t._v("DHCP服务器收到Discover报文后，就会在所配置的地址池中查找一个合适的IP地址，加上相应的租约期限和其他配置信息（如网关、DNS服务器等），构造一个Offer报文，发送给DHCP客户端，告知用户本服务器可以为其提供IP地址。但这个报文只是告诉DHCP客户端可以提供IP地址，最终还需要客户端通过ARP来检测该IP地址是否重复。")]),t._v(" "),a("h3",{attrs:{id:"request"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request"}},[t._v("#")]),t._v(" Request")]),t._v(" "),a("p",[a("strong",[t._v("向DHCP服务器申请获取IP地址")])]),t._v(" "),a("p",[t._v("DHCP客户端可能会收到很多Offer请求报文，所以必须在这些应答中选择一个。通常是选择第一个Offer应答报文的服务器作为自己的目标服务器，并向该服务器发送一个广播的Request请求报文，通告选择的服务器，希望获得所分配的IP地址。另外，DHCP客户端在成功获取IP地址后，在地址使用租期达到50%时，会向DHCP服务器发送单播Request请求报文请求续延租约，如果没有收到ACK报文，在租期达到87.5%时，会再次发送广播的Request请求报文以请求续延租约。")]),t._v(" "),a("h3",{attrs:{id:"ack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ack"}},[t._v("#")]),t._v(" ACK")]),t._v(" "),a("p",[a("strong",[t._v("同意客户端申请IP地址")])]),t._v(" "),a("p",[t._v("DHCP服务器收到Request请求报文后，根据Request报文中携带的用户MAC来查找有没有相应的租约记录，如果有则发送ACK应答报文，通知用户可以使用分配的IP地址。")]),t._v(" "),a("h3",{attrs:{id:"nak"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nak"}},[t._v("#")]),t._v(" NAK")]),t._v(" "),a("p",[a("strong",[t._v("拒绝客户端申请IP地址")])]),t._v(" "),a("p",[t._v("如果DHCP服务器收到Request请求报文后，没有发现有相应的租约记录或者由于某些原因无法正常分配IP地址，则向DHCP客户端发送NAK应答报文，通知用户无法分配合适的IP地址。")]),t._v(" "),a("h3",{attrs:{id:"release"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#release"}},[t._v("#")]),t._v(" Release")]),t._v(" "),a("p",[a("strong",[t._v("客户端表示不需要此IP地址")])]),t._v(" "),a("p",[t._v("当DHCP客户端不再需要使用分配IP地址时（一般出现在客户端关机、下线等状况）就会主动向DHCP服务器发送RELEASE请求报文，告知服务器用户不再需要分配IP地址，请求DHCP服务器释放对应的IP地址。")]),t._v(" "),a("h3",{attrs:{id:"decline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#decline"}},[t._v("#")]),t._v(" Decline")]),t._v(" "),a("p",[a("strong",[t._v("客户端表示此IP地址不可用")])]),t._v(" "),a("p",[t._v("DHCP客户端收到DHCP服务器ACK应答报文后，通过地址冲突检测发现服务器分配的地址冲突或者由于其他原因导致不能使用，则会向DHCP服务器发送Decline请求报文，通知服务器所分配的IP地址不可用，以期获得新的IP地址。")]),t._v(" "),a("h3",{attrs:{id:"inform"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inform"}},[t._v("#")]),t._v(" Inform")]),t._v(" "),a("p",[a("strong",[t._v("客户端想知道更详细的配置信息")])]),t._v(" "),a("p",[t._v("DHCP客户端如果需要从DHCP服务器端获取更为详细的配置信息，则向DHCP服务器发送Inform请求报文；DHCP服务器在收到该报文后，将根据租约进行查找到相应的配置信息后，向DHCP客户端发送ACK应答报文。目前基本上不用了。")]),t._v(" "),a("h2",{attrs:{id:"dhcp-工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dhcp-工作原理"}},[t._v("#")]),t._v(" DHCP 工作原理")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://typora-oss.yixihan.chat//img/202210252156159.png",alt:"image-20221025215620048"}})]),t._v(" "),a("h3",{attrs:{id:"dhcp-报文格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dhcp-报文格式"}},[t._v("#")]),t._v(" DHCP 报文格式")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://typora-oss.yixihan.chat//img/202210252156992.png",alt:"image-20221025215641942"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);